webpackJsonp([7],{CB2s:function(e,a){},HarR:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("3cXf"),l=t.n(s),i=t("P9l9"),r={data:function(){return{userLocalInfo:null,isShow:!0,tableshow:!1,loading:!1,userpermission:null,userperadmin:{},dialogVisible:!1,userlevel:[],superior:[],userdepartment:[],seach:{sessionid:"",name:"",email:"",departmentId:"",level:"",pageId:0,pageSize:10,first:0},currentPage:1,pageSizes:[10,20,50],dataSize:0,pagesize:10,fbsData:[],ruleForm:{sessionid:"",email:"",pwd:"",name:"",departmentId:"",level:"",higherId:""},addSaveLoading:!1,clickGetUserInfo:null,clickJurisdiction:null,showSerch:!0,havedFunGroup:null,useManageVisible:!1,tableloading:!1,manageTile:null,setPermissData:null,saveAddUserInfo:null,addUserId:!1,manageUsers:!1}},mounted:function(){try{for(var e=JSON.parse(unescape(sessionStorage.getItem("userPermiss"))),a=0;a<e.data.length;a++)if("03"==e.data[a].meta)for(var t=0;t<e.data[a].children.length;t++)if("0301"==e.data[a].children[t].meta)for(var s=0;s<e.data[a].children[t].children.length;s++)"030101"==e.data[a].children[t].children[s].meta?this.addUserId="0"!=e.data[a].children[t].children[s].show:"030102"==e.data[a].children[t].children[s].meta&&(this.manageUsers="0"!=e.data[a].children[t].children[s].show)}catch(e){}this.userLocalInfo=JSON.parse(localStorage.getItem("userperadmin"));var l=JSON.parse(localStorage.getItem("userperadmin"));l.admin?(this.userperadmin=l,this.ruleForm.sessionid=this.userperadmin.sessionid,this.seach.sessionid=this.userperadmin.sessionid,this.userpermission=this.userperadmin.admin.level,this.userpermission>2?this.isShow=!1:this.isShow=!0,this.secrch()):this.userperadmin={}},methods:{secrch:function(){var e=this;if(this.seach.email&&!/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/.test(this.seach.email))return void this.$message.error("输入邮箱格式不正确");"0"===this.seach.departmentId&&(this.seach.departmentId=""),"0"===this.seach.level&&(this.seach.level=""),this.loading=!0;var a=l()(this.seach);Object(i.u)(a).then(function(a){if(0===a.data.status)if(e.fbsData=a.data.adminList,e.fbsData.length<1)e.loading=!1,e.tableshow=!1;else{for(var t=0;t<e.fbsData.length;t++)e.fbsData[t].date=e.formatDate(e.fbsData[t].date),5===e.fbsData[t].departmentId?e.fbsData[t].departmentId="运营部":6===e.fbsData[t].departmentId?e.fbsData[t].departmentId="技术部":7===e.fbsData[t].departmentId&&(e.fbsData[t].departmentId="市场部"),1===e.fbsData[t].level?e.fbsData[t].level="一级账号":2===e.fbsData[t].level?e.fbsData[t].level="二级账号":3===e.fbsData[t].level&&(e.fbsData[t].level="三级账号");a.data.listSize?e.dataSize=parseFloat(a.data.listSize):e.dataSize=e.dataSize,e.loading=!1,e.tableshow=!0}else 1===a.data.status&&(e.tableshow=!1,e.$router.replace("/login"))})},addUser:function(){var e=this;this.ruleForm.email="",this.ruleForm.pwd="",this.ruleForm.name="",this.ruleForm.departmentId="",this.ruleForm.level="",this.ruleForm.higherId="",this.userdepartment=[],5===this.userperadmin.admin.departmentId?this.userdepartment.push({name:"运营部",id:5}):6===this.userperadmin.admin.departmentId?this.userdepartment.push({name:"技术部",id:6}):7===this.userperadmin.admin.departmentId&&this.userdepartment.push({name:"市场部",id:7}),this.userlevel=[],1===this.userperadmin.admin.level?this.userlevel=[{name:"二级账号",id:2},{name:"三级账号",id:3}]:this.userlevel=[{name:"三级账号",id:3}];var a={sessionid:this.userperadmin.sessionid};a=l()(a),Object(i.a)(a).then(function(a){0===a.data.status&&(e.superior=a.data.adminList,e.dialogVisible=!0),1===a.data.status&&e.$router.replace("/login")}).catch(function(a){e.$message.error("获取负责人信息失败")})},pageSizeChange:function(e){this.seach.pageSize=e,this.seach.first=1,this.secrch()},currentPageChange:function(e){this.seach.pageId=1*e-1,this.seach.first=1,this.secrch()},adminuser:function(e,a){this.clickGetUserInfo=e,this.havedFunGroup=null;var t={sessionid:this.userLocalInfo.sessionid},s=this;Object(i.P)(t).then(function(e){0===e.data.status&&(s.havedFunGroup=e.data.permissionTypeList,s.showSerch=!1),1===e.data.status&&s.$router.replace("/login")})},readonlyuser:function(e,a){},deleteuser:function(e,a){},submitForm:function(e){var a=this;this.$refs[e].validate(function(e){if(!e)return!1;if(""===a.ruleForm.email)a.$message.error("邮箱不能为空");else if(""===a.ruleForm.pwd)a.$message.error("密码不能为空");else if(""===a.ruleForm.name)a.$message.error("姓名不能为空");else if(""===a.ruleForm.departmentId)a.$message.error("职能部门不能为空");else if(""===a.ruleForm.level)a.$message.error("账号级别不能为空");else if(""===a.ruleForm.higherId)a.$message.error("上司不能为空");else if(a.ruleForm.email){if(!/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/.test(a.ruleForm.email))return void a.$message.error("输入邮箱格式不正确");a.addSaveLoading=!0;var t=a,s=l()(t.ruleForm);Object(i.b)(s).then(function(e){0===e.data.status&&(t.$message({message:e.data.statusMsg,type:"success"}),t.addSaveLoading=!1,t.dialogVisible=!1,t.secrch()),1===e.data.status&&(t.$router.replace("/login"),t.addSaveLoading=!1,t.dialogVisible=!1)}).catch(function(e){t.addSaveLoading=!1,t.dialogVisible=!1,t.$message.error("保存失败")})}})},clickFunGroup:function(e){this.tableloading=!0,this.manageTile=e.name;var a={sessionid:this.userLocalInfo.sessionid,adminid:this.clickGetUserInfo.id,type:e.id};this.saveAddUserInfo=a;var t=this;Object(i.v)(a).then(function(e){if(0===e.data.status){t.setPermissData=e.data.adminPermissionList;for(var a=0;a<e.data.adminPermissionList.length;a++)t.setPermissData[a].show="0"!==e.data.adminPermissionList[a].show;t.tableloading=!1,t.useManageVisible=!0}1===e.data.status&&t.$router.replace("/login")})},clickShowuse:function(e,a){var t={sessionid:this.saveAddUserInfo.sessionid,type:this.saveAddUserInfo.type,adminid:this.saveAddUserInfo.adminid,id:e.id,name:e.name,show:e.show},s=this;Object(i.c)(t).then(function(a){e.id=a.data.id,0===a.data.status&&s.$message({message:"修改"+e.name+"授权成功",type:"success"}),1===a.data.status&&s.$router.replace("/login")})}}},n={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"UserControl"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showSerch,expression:"!showSerch"}],staticClass:"header",staticStyle:{"text-align":"left"}},[t("el-button",{staticStyle:{border:"0px"},attrs:{size:"small"},nativeOn:{click:function(a){e.showSerch=!0}}},[e._v("返回账号信息")])],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showSerch,expression:"showSerch"}],staticClass:"seachInfoFun"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:3,sm:3,md:4}},[t("el-input",{attrs:{placeholder:"姓名搜索"},model:{value:e.seach.name,callback:function(a){e.$set(e.seach,"name",a)},expression:"seach.name"}})],1),e._v(" "),t("el-col",{attrs:{xs:3,sm:3,md:4}},[t("el-input",{attrs:{placeholder:"邮箱搜索"},model:{value:e.seach.email,callback:function(a){e.$set(e.seach,"email",a)},expression:"seach.email"}})],1),e._v(" "),t("el-col",{attrs:{xs:4,sm:3,md:4}},[t("el-select",{attrs:{placeholder:"选择职能部门"},model:{value:e.seach.departmentId,callback:function(a){e.$set(e.seach,"departmentId",a)},expression:"seach.departmentId"}},[t("el-option",{attrs:{label:"全部",value:"0"}}),e._v(" "),t("el-option",{attrs:{label:"市场部",value:"7"}}),e._v(" "),t("el-option",{attrs:{label:"运营部",value:"5"}}),e._v(" "),t("el-option",{attrs:{label:"技术部",value:"6"}})],1)],1),e._v(" "),t("el-col",{attrs:{xs:4,sm:3,md:4}},[t("el-select",{attrs:{placeholder:"选择账号等级"},model:{value:e.seach.level,callback:function(a){e.$set(e.seach,"level",a)},expression:"seach.level"}},[t("el-option",{attrs:{label:"全部",value:"0"}}),e._v(" "),t("el-option",{attrs:{label:"一级账号",value:"1"}}),e._v(" "),t("el-option",{attrs:{label:"二级账号",value:"2"}}),e._v(" "),t("el-option",{attrs:{label:"三级账号",value:"3"}})],1)],1),e._v(" "),t("el-col",{attrs:{xs:10,sm:8,md:6}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.secrch}}),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.addUserId,expression:"addUserId"}],attrs:{type:"success",icon:"el-icon-plus",size:"small"},on:{click:e.addUser}})],1)],1),e._v(" "),t("div",{staticClass:"table-wrapper"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"90%"},attrs:{data:e.fbsData,border:"",size:"small","element-loading-text":"拼命加载中...","highlight-current-row":!0}},[t("el-table-column",{attrs:{prop:"name",label:"姓名",width:"80"}}),e._v(" "),t("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"200"}}),e._v(" "),t("el-table-column",{attrs:{prop:"departmentId",label:"职能部门"}}),e._v(" "),t("el-table-column",{attrs:{prop:"level",label:"账号等级"}}),e._v(" "),t("el-table-column",{attrs:{prop:"date",label:"创建时间",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"showTitle",label:"权限管理"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.manageUsers,expression:"manageUsers"}],attrs:{"close-transition":"",type:"text",size:"small"},on:{click:function(t){e.adminuser(a.row,a.$index)}}},[e._v("管理")])]}}])})],1),e._v(" "),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableshow,expression:"tableshow"}],staticClass:"paginationWrapper",attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.dataSize},on:{"size-change":e.pageSizeChange,"current-change":e.currentPageChange}})],1),e._v(" "),t("el-dialog",{attrs:{title:"创建新用户",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(a){e.dialogVisible=a}}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"邮箱(账号)",prop:"email"}},[t("el-input",{model:{value:e.ruleForm.email,callback:function(a){e.$set(e.ruleForm,"email",a)},expression:"ruleForm.email"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[t("el-input",{model:{value:e.ruleForm.pwd,callback:function(a){e.$set(e.ruleForm,"pwd",a)},expression:"ruleForm.pwd"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(a){e.$set(e.ruleForm,"name",a)},expression:"ruleForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"职能部门",prop:"departmentId"}},[t("el-select",{attrs:{placeholder:"选择职能部门"},model:{value:e.ruleForm.departmentId,callback:function(a){e.$set(e.ruleForm,"departmentId",a)},expression:"ruleForm.departmentId"}},e._l(e.userdepartment,function(e){return t("div",[t("el-option",{attrs:{label:e.name,value:e.id}})],1)}))],1),e._v(" "),t("el-form-item",{attrs:{label:"账号级别",prop:"level"}},[t("el-select",{attrs:{placeholder:"选择账号级别"},model:{value:e.ruleForm.level,callback:function(a){e.$set(e.ruleForm,"level",a)},expression:"ruleForm.level"}},e._l(e.userlevel,function(e){return t("div",[t("el-option",{attrs:{label:e.name,value:e.id}})],1)}))],1),e._v(" "),t("el-form-item",{attrs:{label:"上司",prop:"higherId"}},[t("el-select",{attrs:{placeholder:"默认创建者"},model:{value:e.ruleForm.higherId,callback:function(a){e.$set(e.ruleForm,"higherId",a)},expression:"ruleForm.higherId"}},e._l(e.superior,function(e){return t("div",[t("el-option",{attrs:{label:e.name,value:e.id}})],1)}))],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.addSaveLoading},on:{click:function(a){e.submitForm("ruleForm")}}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:function(a){e.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showSerch,expression:"!showSerch"}],staticClass:"fungroup"},e._l(e.havedFunGroup,function(a,s){return t("div",{staticClass:"havedGroup"},[t("el-button",{staticClass:"btnStyle",on:{click:function(t){e.clickFunGroup(a)}}},[e._v(e._s(a.name))])],1)})),e._v(" "),t("el-dialog",{attrs:{title:e.manageTile,visible:e.useManageVisible,width:"50%"},on:{"update:visible":function(a){e.useManageVisible=a}}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],staticStyle:{width:"100%"},attrs:{data:e.setPermissData,border:"",size:"mini","element-loading-text":"拼命加载中..."}},[t("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),t("el-table-column",{attrs:{label:"功能名称"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"clickSpanStyle"},[e._v(e._s(a.row.name))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"className",label:"授权"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#999999"},on:{change:function(t){e.clickShowuse(a.row,a.$index)}},model:{value:a.row.show,callback:function(t){e.$set(a.row,"show",t)},expression:"scope.row.show"}})]}}])})],1)],1)],1)},staticRenderFns:[]},o=t("Z0/y")(r,n,!1,function(e){t("CB2s")},"data-v-475360d6",null);a.default=o.exports}});
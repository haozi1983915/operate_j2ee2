webpackJsonp([11],{Smy7:function(e,t){},hyzq:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("P9l9"),n={data:function(){return{sessionidInfo:null,tableloading:!1,fbsData:[],reviseVisible:!1,FunctionVisible:!1,useManageVisible:!1,manageTile:"",funGroupName:"",isRepetition:null,isFunRepetition:null,isFunMetaRepetition:null,isFunMetaRepetSpan:!1,addFunInfo:{changeFunGroup:"",funName:"",isShow:"",isgetUse:"",meta:""},options:[],setPermissData:[],clickIndex:null,changeInputValue:"",addGroupUser:!1,addFunctionUser:!1,lookFunSet:!1,saveSetFun:!1}},mounted:function(){var e=JSON.parse(unescape(sessionStorage.getItem("userPermiss")));try{for(var t=0;t<e.data.length;t++)if("04"==e.data[t].meta)for(var s=0;s<e.data[t].children.length;s++)if("0401"==e.data[t].children[s].meta)for(var a=0;a<e.data[t].children[s].children.length;a++)"040101"==e.data[t].children[s].children[a].meta?this.addGroupUser="0"!=e.data[t].children[s].children[a].show:"040102"==e.data[t].children[s].children[a].meta?this.addFunctionUser="0"!=e.data[t].children[s].children[a].show:"040103"==e.data[t].children[s].children[a].meta?this.lookFunSet="0"!=e.data[t].children[s].children[a].show:"040104"==e.data[t].children[s].children[a].meta&&(this.saveSetFun="0"!=e.data[t].children[s].children[a].show)}catch(e){}this.sessionidInfo=JSON.parse(localStorage.getItem("userperadmin")),this.getAllFunGroup()},filters:{formatDate:function(e,t){var s=new Date(e),a=s.getFullYear(),n=s.getMonth()+1,i=s.getDate(),o=s.getHours(),l=s.getMinutes(),u=s.getSeconds();return a+"-"+n+"-"+i+" "+o+":"+l+":"+(u>=10?u:"0"+u)}},methods:{getAllFunGroup:function(){var e=this,t={sessionid:this.sessionidInfo.sessionid};Object(a._0)(t).then(function(t){0===t.data.status&&(e.fbsData=t.data.permissionTypeList),1===t.data.status&&e.$router.replace("/login")})},addGroup:function(){this.funGroupName="",this.reviseVisible=!0},addFun:function(){this.addFunInfo.changeFunGroup="",this.addFunInfo.funName="",this.addFunInfo.isShow="1",this.addFunInfo.isgetUse="1",this.addFunInfo.meta="",this.options=[];for(var e=0;e<this.fbsData.length;e++)this.options.push({value:this.fbsData[e].id,label:this.fbsData[e].name});this.FunctionVisible=!0},funManageName:function(){var e={sessionid:this.sessionidInfo.sessionid,name:this.funGroupName},t=this;t.funGroupName&&Object(a.s)(e).then(function(e){if(0===e.data.status)t.isRepetition=0;else if(1===e.data.status)t.$router.replace("/login");else{if(2===e.data.status)return t.$message.error("功能组名称不能重复"),void(t.isRepetition=1);t.isRepetition=null}})},saveFunGroup:function(){if(this.funGroupName){null==this.funGroupName&&this.funManageName();var e={sessionid:this.sessionidInfo.sessionid,name:this.funGroupName},t=this;Object(a.i)(e).then(function(e){0===e.data.status&&(t.$message({message:"添加功能组成功",type:"success"}),t.reviseVisible=!1,t.getAllFunGroup()),1===e.data.status&&t.$router.replace("/login")})}else this.$message.error("添加功能组名称不能为空")},funNameRep:function(){var e={sessionid:this.sessionidInfo.sessionid,name:this.addFunInfo.funName},t=this;Object(a.r)(e).then(function(e){0===e.data.status?t.isFunRepetition=0:1===e.data.status?t.$router.replace("/login"):2===e.data.status?(t.$message.error("功能名称重复"),t.isFunRepetition=1):t.isFunRepetition=null})},funIDRep:function(){var e={sessionid:this.sessionidInfo.sessionid,meta:this.addFunInfo.meta},t=this;Object(a.p)(e).then(function(e){0===e.data.status?(t.isFunMetaRepetition=0,t.isFunMetaRepetSpan=!1):1===e.data.status?t.$router.replace("/login"):2===e.data.status?(t.isFunMetaRepetSpan=!0,t.isFunMetaRepetition=1):(t.isFunMetaRepetition=null,t.isFunMetaRepetSpan=!1)})},saveAddFunction:function(){if(this.addFunInfo.changeFunGroup)if(this.addFunInfo.funName)if(this.addFunInfo.meta)if(this.addFunInfo.meta&&2!==this.addFunInfo.meta.length&&4!==this.addFunInfo.meta.length&&6!==this.addFunInfo.meta.length)this.$message.error("功能ID长度必须2位/4位/6位");else{var e={sessionid:this.sessionidInfo.sessionid,name:this.addFunInfo.funName,type:this.addFunInfo.changeFunGroup,meta:this.addFunInfo.meta,allshow:parseInt(this.addFunInfo.isShow),isuse:parseInt(this.addFunInfo.isgetUse)},t=this;Object(a.h)(e).then(function(e){0===e.data.status&&(t.$message({message:"添加功能成功",type:"success"}),t.FunctionVisible=!1),1===e.data.status&&t.$router.replace("/login")})}else this.$message.error("功能ID不能为空");else this.$message.error("功能名称不能为空");else this.$message.error("请选择归属功能组")},useManage:function(e,t){var s=this;this.clickIndex=null;var n={sessionid:this.sessionidInfo.sessionid,type:e.id};Object(a.Z)(n).then(function(t){if(0===t.data.status){s.setPermissData=t.data.permissions;for(var a=0;a<s.setPermissData.length;a++)s.setPermissData[a].allshow=0!==s.setPermissData[a].allshow,s.setPermissData[a].isuse=0!==s.setPermissData[a].isuse;s.useManageVisible=!0,s.manageTile=e.name+"功能管理"}1===t.data.status&&s.$router.replace("/login")})},clickShowList:function(e,t,s){this.setFunName(e)},clickShowuse:function(e){this.setFunName(e)},setFunName:function(e){var t={sessionid:this.sessionidInfo.sessionid,id:e.id,name:e.name,type:e.type,allshow:e.allshow,isuse:e.isuse,meta:e.meta},s=this;Object(a._21)(t).then(function(t){0===t.data.status&&s.$message({message:"修改"+e.name+"保存功能成功",type:"success"}),1===t.data.status&&s.$router.replace("/login")})}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"groupBox"},[s("div",{staticClass:"clickBtn"},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.addGroupUser,expression:"addGroupUser"}],staticClass:"btnStyleone",attrs:{type:"primary",size:"small"},on:{click:e.addGroup}},[e._v("添加功能组")]),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.addFunctionUser,expression:"addFunctionUser"}],staticClass:"btnStyletow",attrs:{type:"primary",size:"small"},on:{click:e.addFun}},[e._v("添加功能")])],1),e._v(" "),s("div",{staticClass:"tablesys"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],staticStyle:{width:"80%"},attrs:{data:e.fbsData,border:"",size:"mini","element-loading-text":"拼命加载中...","highlight-current-row":!0}},[s("el-table-column",{attrs:{type:"index",label:"排序"}}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e._f("formatDate")(t.row.updateTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"adminName",label:"创建人"}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"组名"}}),e._v(" "),s("el-table-column",{attrs:{label:"管理"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.lookFunSet,expression:"lookFunSet"}],attrs:{type:"text",size:"small"},on:{click:function(s){e.useManage(t.row,t.$index)}}},[s("i",{staticClass:"fa fa-align-justify"})])]}}])})],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"添加一个功能组",visible:e.reviseVisible,width:"50%"},on:{"update:visible":function(t){e.reviseVisible=t}}},[s("el-form",[s("el-row",{staticStyle:{"padding-bottom":"20px"}},[s("el-col",{attrs:{span:4}},[e._v("功能组名称:")]),e._v(" "),s("el-col",{attrs:{span:17}},[s("el-input",{attrs:{placeholder:"请输入内容"},on:{input:e.funManageName},model:{value:e.funGroupName,callback:function(t){e.funGroupName=t},expression:"funGroupName"}})],1)],1)],1),e._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.reviseVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveFunGroup}},[e._v("提交")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"添加一个功能",visible:e.FunctionVisible,width:"50%"},on:{"update:visible":function(t){e.FunctionVisible=t}}},[s("el-form",[s("el-row",[s("div",{staticClass:"showPadding"},[s("el-col",{attrs:{span:4}},[e._v("归属功能组:")]),e._v(" "),s("el-col",{attrs:{span:17}},[s("el-select",{attrs:{placeholder:"选择功能组"},model:{value:e.addFunInfo.changeFunGroup,callback:function(t){e.$set(e.addFunInfo,"changeFunGroup",t)},expression:"addFunInfo.changeFunGroup"}},e._l(e.options,function(e,t){return s("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),s("div",{staticClass:"showPadding"},[s("el-col",{attrs:{span:4}},[e._v("功能名称:")]),e._v(" "),s("el-col",{attrs:{span:17}},[s("el-input",{attrs:{placeholder:"请输入名称"},on:{input:e.funNameRep},model:{value:e.addFunInfo.funName,callback:function(t){e.$set(e.addFunInfo,"funName",t)},expression:"addFunInfo.funName"}})],1)],1),e._v(" "),s("div",{staticClass:"showPadding"},[s("el-col",{attrs:{span:4}},[e._v("ID:")]),e._v(" "),s("el-col",{attrs:{span:17}},[s("el-input",{attrs:{maxlength:6,placeholder:"请输入唯一ID(2或4或6位)"},on:{input:e.funIDRep},model:{value:e.addFunInfo.meta,callback:function(t){e.$set(e.addFunInfo,"meta",t)},expression:"addFunInfo.meta"}}),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.isFunMetaRepetSpan,expression:"isFunMetaRepetSpan"}],staticClass:"fontSizeSty"},[e._v("功能ID名称重复")])],1)],1),e._v(" "),s("div",{staticClass:"showPadding"},[s("el-col",{attrs:{span:4}},[e._v("在列表显示:")]),e._v(" "),s("el-col",{attrs:{span:17}},[s("el-radio",{attrs:{label:"1"},model:{value:e.addFunInfo.isShow,callback:function(t){e.$set(e.addFunInfo,"isShow",t)},expression:"addFunInfo.isShow"}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:"0"},model:{value:e.addFunInfo.isShow,callback:function(t){e.$set(e.addFunInfo,"isShow",t)},expression:"addFunInfo.isShow"}},[e._v("否")])],1)],1),e._v(" "),s("div",[s("el-col",{attrs:{span:4}},[e._v("是否限权:")]),e._v(" "),s("el-col",{attrs:{span:17}},[s("el-radio",{attrs:{label:"1"},model:{value:e.addFunInfo.isgetUse,callback:function(t){e.$set(e.addFunInfo,"isgetUse",t)},expression:"addFunInfo.isgetUse"}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:"0"},model:{value:e.addFunInfo.isgetUse,callback:function(t){e.$set(e.addFunInfo,"isgetUse",t)},expression:"addFunInfo.isgetUse"}},[e._v("否")])],1)],1)])],1),e._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.FunctionVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveAddFunction}},[e._v("提交")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.manageTile,visible:e.useManageVisible,width:"50%"},on:{"update:visible":function(t){e.useManageVisible=t}}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],staticStyle:{width:"100%"},attrs:{data:e.setPermissData,border:"",size:"mini","element-loading-text":"拼命加载中..."}},[s("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),s("el-table-column",{attrs:{label:"功能名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.clickIndex!==t.$index?s("span",{staticClass:"clickSpanStyle"},[e._v(e._s(t.row.name))]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"className",label:"是否显示在列表"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{directives:[{name:"show",rawName:"v-show",value:e.saveSetFun,expression:"saveSetFun"}],attrs:{"active-color":"#13ce66","inactive-color":"#999999"},on:{change:function(s){e.clickShowList(t.row,t.$index)}},model:{value:t.row.allshow,callback:function(s){e.$set(t.row,"allshow",s)},expression:"scope.row.allshow"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"className",label:"是否限权"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{directives:[{name:"show",rawName:"v-show",value:e.saveSetFun,expression:"saveSetFun"}],attrs:{"active-color":"#13ce66","inactive-color":"#999999"},on:{change:function(s){e.clickShowuse(t.row,t.$index)}},model:{value:t.row.isuse,callback:function(s){e.$set(t.row,"isuse",s)},expression:"scope.row.isuse"}})]}}])})],1)],1)],1)},staticRenderFns:[]},o=s("Z0/y")(n,i,!1,function(e){s("Smy7")},"data-v-20f00b56",null);t.default=o.exports}});
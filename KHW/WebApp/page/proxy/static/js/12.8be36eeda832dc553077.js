webpackJsonp([12],{"+jJ9":function(t,e){},pD0n:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("dia3"),i=s("P9l9"),n={data:function(){var t=this;return{adminInfo:null,divHearderInfo:!0,statrMonth:"",endMonth:"",fuzherenData:"",fuzherenNochoose:[],checkList:["负责人"],chooseFuzheren:[],pickerOptions0:{disabledDate:function(e){if(""!=t.endMonth)return e.getTime()>t.endMonth}},pickerOptions1:{disabledDate:function(e){return e.getTime()<t.statrMonth}},fbsData:[],tableloading:!1,tableAdminL:!0,addVisible:!1,chooseMonth:"",fbsDataModel:[],inputKIP:null,modelDate:"",detailsVisible:!1,detailsData:[],resiveVisible:!1,reviseMonth:"",reviseAdmin:"",adminIdInfo:"",reviseKPI:null}},mounted:function(){this.adminInfo=JSON.parse(localStorage.getItem("userperadmin")),this.getAdminInfo(),this.getNewMonth()},methods:{getAdminInfo:function(){var t={sessionid:this.adminInfo.sessionid},e=this;Object(i._13)(t).then(function(t){if(0===t.data.status){e.chooseFuzheren=t.data.adminList;for(var s=0;s<t.data.adminList.length;s++)e.fuzherenNochoose.push(t.data.adminList[s].id);e.divHearderInfo=!1,e.clickSearch()}1===t.data.status&&e.$router.replace("/login")})},getNewMonth:function(){this.statrMonth=Object(a.d)(),this.endMonth=Object(a.d)()},statrMonthFocus:function(){this.statrMonth=""},endMonthFocus:function(){this.endMonth=""},addKPISet:function(){if(this.addVisible=!0,this.modelDate="",this.chooseMonth="",this.fbsDataModel=[],this.chooseFuzheren&&this.chooseFuzheren.length>0)for(var t=0;t<this.chooseFuzheren.length;t++)this.fbsDataModel.push({month:"",adminName:this.chooseFuzheren[t].name,adminId:this.chooseFuzheren[t].id,KPI:null});else this.$message.error("负责人信息获取失败，请刷新重试")},KPIValue:function(t,e){},ensure:function(t){if(t){var e=t.getFullYear()+"-"+(t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1));this.modelDate=e}},submitInfo:function(){var t={sessionid:this.adminInfo.sessionid,subStatus:0,KPI:this.fbsDataModel};if(""!=this.modelDate){var e=this;Object(i._14)(t).then(function(t){0===t.data.status&&(e.$message({message:"KPI设定成功",type:"success"}),e.addVisible=!1),1===t.data.status&&e.$router.replace("/login")})}else this.$message.error("请先进行添加月份再进行保存")},clickSearch:function(){var t,e,s,n,o;if(this.statrMonth?(t=this.dataToMs(this.statrMonth),e=Object(a.b)(t)):e="",this.endMonth?(s=this.dataToMs(this.endMonth),n=Object(a.b)(s)):n="",o=this.fuzherenData?[this.fuzherenData]:this.fuzherenNochoose,e>n)this.$message.error("结束月不能小于开始月");else{this.tableloading=!0;var l={sessionid:this.adminInfo.sessionid,maxDate:n,minDate:e,adminid:o},r=this;Object(i.B)(l).then(function(t){0===t.data.status&&(r.fbsData=t.data.reportforms_admin,r.tableloading=!1),1===t.data.status&&r.$router.replace("/login")})}},chaneAdminSataus:function(){this.tableAdminL=!this.tableAdminL},lookDetails:function(t,e){var s={sessionid:this.adminInfo.sessionid,adminid:t.adminid,month:t.month},a=this;Object(i._12)(s).then(function(t){0===t.data.status&&(a.detailsData=t.data.reportforms_admin,a.detailsVisible=!0),1===t.data.status&&a.$router.replace("/login")})},reviseRowInfo:function(t,e){this.reviseMonth="",this.reviseKPI="",this.reviseAdmin=t.name,this.adminIdInfo=t.adminid,this.reviseMonth=t.month,this.resiveVisible=!0},saverevise:function(){if(this.reviseMonth){var t=this.dataToMs(this.reviseMonth),e={month:Object(a.b)(t),adminId:this.adminIdInfo,adminName:this.reviseAdmin,KPI:this.reviseKPI},s={sessionid:this.adminInfo.sessionid,KPI:[e]},n=this;Object(i._14)(s).then(function(t){0===t.data.status&&(n.$message({message:"修改保存成功",type:"success"}),n.resiveVisible=!1,n.clickSearch()),1===t.data.status&&n.$router.replace("/login")})}else this.$message.error("月份不能为空")}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"kpicenter"},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.divHearderInfo,expression:"divHearderInfo"}],staticClass:"searchHeader",attrs:{"element-loading-text":"拼命加载中..."}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:20}},[s("span",{staticClass:"demonstration"},[t._v("起止时间:")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"开始月","picker-options":t.pickerOptions0,editable:!1,size:"small"},on:{focus:t.statrMonthFocus},model:{value:t.statrMonth,callback:function(e){t.statrMonth=e},expression:"statrMonth"}}),t._v(" "),s("span",{staticClass:"demonstration"},[t._v("~")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"结束月","picker-options":t.pickerOptions1,editable:!1,size:"small"},on:{focus:t.endMonthFocus},model:{value:t.endMonth,callback:function(e){t.endMonth=e},expression:"endMonth"}})],1)],1),t._v(" "),s("el-row",{staticClass:"fuzherenStyle",attrs:{gutter:20}},[s("el-col",{attrs:{span:5}},[s("el-select",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",clearable:"",placeholder:"选择负责人"},model:{value:t.fuzherenData,callback:function(e){t.fuzherenData=e},expression:"fuzherenData"}},t._l(t.chooseFuzheren,function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),s("el-col",{staticClass:"cheackMarginTop",attrs:{span:3}},[s("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[s("el-checkbox",{attrs:{label:"负责人"},on:{change:t.chaneAdminSataus}})],1)],1),t._v(" "),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:t.clickSearch}})],1),t._v(" "),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-plus"},on:{click:t.addKPISet}})],1)],1)],1),t._v(" "),s("div",{staticClass:"tableMargin"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableloading,expression:"tableloading"}],staticStyle:{width:"100%"},attrs:{data:t.fbsData,height:t.fbsData&&t.fbsData.length>0?480:120,border:"",size:"mini","element-loading-text":"拼命加载中...","highlight-current-row":!0}},[s("el-table-column",{attrs:{type:"index",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"month",label:"月份",width:"180"}}),t._v(" "),t.tableAdminL?s("el-table-column",{attrs:{prop:"name",label:"负者人"}}):t._e(),t._v(" "),s("el-table-column",{attrs:{prop:"registerkpi",label:"注册KPI"}}),t._v(" "),s("el-table-column",{attrs:{prop:"register",label:"调整记录"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{"close-transition":"",size:"mini"},on:{click:function(s){t.lookDetails(e.row,e.$index)}}},[t._v("查看详情")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"upload",label:"编辑"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{"close-transition":"",size:"mini"},on:{click:function(s){t.reviseRowInfo(e.row,e.$index)}}},[t._v("修改")])]}}])})],1)],1),t._v(" "),s("div",{staticClass:"addModel"},[s("el-dialog",{staticClass:"modelHeight",attrs:{title:"KPI设定",visible:t.addVisible,width:"50%"},on:{"update:visible":function(e){t.addVisible=e}}},[s("el-form",{staticStyle:{"max-height":"18rem"}},[s("div",{staticClass:"addModelHeader"},[s("span",{staticClass:"demonstration"},[t._v("选择月份:")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"选择月",editable:!1,size:"small"},model:{value:t.chooseMonth,callback:function(e){t.chooseMonth=e},expression:"chooseMonth"}}),t._v("   \n\t\t\t\t\t\t  "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.ensure(t.chooseMonth)}}},[t._v("确定")])],1),t._v(" "),s("div",{staticClass:"tableMargin"},[s("el-table",{staticStyle:{width:"100%",height:"15rem","overflow-y":"scroll"},attrs:{data:t.fbsDataModel,border:"",size:"mini","show-summary":""}},[s("el-table-column",{attrs:{type:"index",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"month",label:"月份",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.month=t.modelDate))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"adminName",label:"负责人"}}),t._v(" "),s("el-table-column",{attrs:{prop:"KPI",label:"注册KPI"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input",{attrs:{size:"small",maxlength:15},on:{input:function(s){t.KPIValue(e.row,e.$index)}},model:{value:e.row.KPI,callback:function(s){t.$set(e.row,"KPI",s)},expression:"scope.row.KPI"}})]}}])})],1)],1)]),t._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submitInfo}},[t._v("提交")])],1)],1)],1),t._v(" "),s("div",[s("el-dialog",{attrs:{title:"详情",visible:t.detailsVisible,width:"50%"},on:{"update:visible":function(e){t.detailsVisible=e}}},[s("el-form",{staticStyle:{height:"15rem","overflow-y":"scroll"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.detailsData,border:"",size:"mini","show-summary":""}},[s("el-table-column",{attrs:{type:"index",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"负责人"}}),t._v(" "),s("el-table-column",{attrs:{prop:"registerkpi",label:"注册KPI"}}),t._v(" "),s("el-table-column",{attrs:{prop:"updatetime",label:"调整时间"}}),t._v(" "),s("el-table-column",{attrs:{prop:"updatename",label:"操作人"}})],1)],1)],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"修改",visible:t.resiveVisible,width:"50%"},on:{"update:visible":function(e){t.resiveVisible=e}}},[s("el-form",[s("el-row",{staticStyle:{"padding-bottom":"20px"}},[s("div",{staticClass:"showPadding"},[s("el-col",{attrs:{span:4}},[t._v("月份:")]),t._v(" "),s("el-col",{attrs:{span:17}},[s("el-date-picker",{attrs:{type:"month",placeholder:"选择月",editable:!1,size:"small"},model:{value:t.reviseMonth,callback:function(e){t.reviseMonth=e},expression:"reviseMonth"}})],1)],1),t._v(" "),s("div",{staticClass:"showPadding"},[s("el-col",{attrs:{span:4}},[t._v("负责人:")]),t._v(" "),s("el-col",{attrs:{span:17}},[t._v(t._s(t.reviseAdmin))])],1),t._v(" "),s("div",{staticClass:"showPadding"},[s("el-col",{attrs:{span:4}},[t._v("KPI:")]),t._v(" "),s("el-col",{attrs:{span:17}},[s("el-input",{attrs:{placeholder:"请输入KPI",maxlength:15},model:{value:t.reviseKPI,callback:function(e){t.reviseKPI=e},expression:"reviseKPI"}})],1)],1)])],1),t._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.saverevise}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]},l=s("vSla")(n,o,!1,function(t){s("+jJ9")},"data-v-235125ce",null);e.default=l.exports}});
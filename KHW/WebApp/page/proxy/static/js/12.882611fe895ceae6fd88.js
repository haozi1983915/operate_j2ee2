webpackJsonp([12],{Ia6a:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),d=a.n(i),n=a("P9l9"),s={data:function(){return{sessionidobj:{},savelog:!1,modeTitle:"",addInfo:{},creatAdminId:"",name:"",dialogVisible:!1,loading:!0,data4:[{id:1,label:"免费流量",children:[{id:3,label:"BD",children:[{id:7,label:"甲方合作"}]},{id:10,label:"市场",children:[{id:7,label:"应用市场"}]}]},{id:2,label:"付费流量",children:[{id:5,label:"BD",children:[{id:9,label:"CPS业务"},{id:10,label:"贷款超市"},{id:11,label:"甲方合作"}]},{id:6,label:"市场",children:[{id:12,label:"应用市场"},{id:13,label:"程序化购物"},{id:14,label:"ASO"}]}]}],defaultProps:{children:"children",label:"label"},data5:[]}},mounted:function(){var e=JSON.parse(localStorage.getItem("userperadmin")).sessionid;this.sessionidobj=d()({sessionid:e}),this.creatAdminId=e,this.getChannel(this.sessionidobj)},methods:{getChannel:function(e){var t=this,a=this;a.data5=[],Object(n.S)(e).then(function(e){if(0===e.data.status){t.loading=!1;for(var i=e.data.channelAttribute,d=e.data.channelType,n=e.data.channelSubdivision,s=0;s<i.length;s++){var l=a.formatDate(i[s].updateTime),r=i[s].id,o=i[s].creatAdmin,c=i[s].higherId,m=i[s].type,h=i[s].creatAdminId,p=i[s].name,u=i[s].updateAdmin,f=i[s].updateAdminId,g=i[s].updateTime,I=p+"/创建:"+o+"/最后操作:"+u+"/修改:"+l;a.data5.push({id:r,label:I,creatAdmin:o,higherId:c,type:m,creatAdminId:h,name:p,updateAdmin:u,updateAdminId:f,updateTime:g}),a.data5[s].children=[];for(var b=0;b<d.length;b++)if(i[s].id===d[b].higherId){var A=a.formatDate(d[b].updateTime),v=d[b].id,y=d[b].creatAdmin,T=d[b].higherId,x=d[b].type,_=d[b].creatAdminId,k=d[b].name,C=d[b].updateAdmin,j=d[b].updateAdminId,O=d[b].updateTime,V=k+"/创建:"+y+"/最后操作:"+C+"/修改:"+A;a.data5[s].children.push({id:v,label:V,creatAdmin:y,higherId:T,type:x,creatAdminId:_,name:k,updateAdmin:C,updateAdminId:j,updateTime:O})}}for(s=0;s<a.data5.length;s++)for(b=0;b<a.data5[s].children.length;b++){a.data5[s].children[b].children=[];for(var $=0;$<n.length;$++)if(a.data5[s].children[b].id==n[$].higherId){var z=a.formatDate(n[$].updateTime),D=n[$].id,S=n[$].creatAdmin,w=n[$].higherId,P=n[$].type,J=n[$].creatAdminId,F=n[$].name,B=n[$].updateAdmin,K=n[$].updateAdminId,M=n[$].updateTime,N=F+"/创建:"+S+"/最后操作:"+B+"/修改:"+z;a.data5[s].children[b].children.push({id:D,label:N,creatAdmin:S,higherId:w,type:P,creatAdminId:J,name:F,updateAdmin:B,updateAdminId:K,updateTime:M})}}a.data4=a.data5}1===e.data.status&&(t.loading=!1,t.$router.replace("/login"))}).catch(function(e){t.$message.error("数据获取失败,请联系管理员")})},appendFirst:function(){this.addInfo={},this.modeTitle="添加",this.dialogVisible=!0;var e=(new Date).valueOf();this.addInfo={sessionid:this.creatAdminId,creatAdminId:this.creatAdminId,name:this.name,higherId:0,updateAdminId:this.creatAdminId,updateTime:e,type:3}},append:function(e,t){this.addInfo={},this.dialogVisible=!0;var a=(new Date).valueOf();0===t&&(this.modeTitle="添加--"+e.name+"--子标签",this.addInfo={sessionid:this.creatAdminId,creatAdminId:this.creatAdminId,name:this.name,higherId:e.id,updateAdminId:this.creatAdminId,updateTime:a,type:e.type+1}),1===t&&(this.modeTitle="修改:"+e.name,this.addInfo={sessionid:this.creatAdminId,creatAdminId:e.creatAdminId,name:this.name,higherId:e.higherId,updateAdminId:this.creatAdminId,updateTime:a,type:e.type,id:e.id})},saveAddInfo:function(){this.savelog=!0;var e=this;if(e.addInfo.name){var t=d()(e.addInfo);Object(n._23)(t).then(function(t){0===t.data.status&&(e.savelog=!1,e.dialogVisible=!1,e.$message({message:"保存成功",type:"success"}),e.getChannel(e.sessionidobj)),1===t.data.status&&(e.savelog=!1,e.dialogVisible=!1,e.$message.error(t.data.statusMsg))}).catch(function(t){e.$message.error("保存失败")})}else e.savelog=!1,e.$message.error("添加的名字不能为空")},renderContent:function(e,t){var a=this,i=t.node,d=t.data,n=(t.store,i.label.indexOf("/")),s=i.label.substring(0,n),l=i.label.substring(n);return e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",[e("span",{style:"font-size:0.7rem;color:#333333"},[s]),e("span",{style:"font-size:0.6rem;color:#999999"},[l])]),e("span",[e("el-button",{style:"font-size: 12px;",attrs:{type:"text"},on:{click:function(){return a.append(d,0)}}},[d.type<=4?"添加":""]),e("el-button",{style:"font-size: 12px;",attrs:{type:"text"},on:{click:function(){return a.append(d,1)}}},["修改"]),e("el-button",{style:"font-size: 12px;display:none",attrs:{type:"text"},on:{click:function(){return a.remove(i,d)}}},["删除"])])])}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"channelclass",attrs:{"element-loading-text":"拼命加载中..."}},[a("div",{staticClass:"addfrist"},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus",size:"mini"},on:{click:e.appendFirst}})],1),e._v(" "),a("div",{staticClass:"tree"},[a("el-tree",{attrs:{data:e.data4,props:e.defaultProps,"default-expand-all":"","node-key":"id","expand-on-click-node":!1,"render-content":e.renderContent}}),e._v(" "),a("el-dialog",{attrs:{title:e.modeTitle,visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入添加名称内容"},model:{value:e.addInfo.name,callback:function(t){e.$set(e.addInfo,"name",t)},expression:"addInfo.name"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.savelog},on:{click:e.saveAddInfo}},[e._v("保存")])],1)],1)],1)])},staticRenderFns:[]},r=a("vSla")(s,l,!1,function(e){a("ryKJ")},null,null);t.default=r.exports},ryKJ:function(e,t){}});
webpackJsonp([4],{aMRy:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("P9l9"),s=t("dia3"),l={data:function(){return{userperadmin:{},first:0,searchInfo:{channelNameSelected:"",channelNameList:[],channelSelected:"",channelList:[],dateRange:[],start:"",end:"",loading:!1,first:0},tableInfo:{tableData:[],pageId:1,pageSize:10,pageSizes:[10,20,50,100,500,1e3],dataSize:0,first:1},deleteInfo:{data:[]},loading:!1,dialogInfo:{flag:!0,visible:!1,data:[]},deleteHistory:!1}},mounted:function(){for(var e=JSON.parse(unescape(sessionStorage.getItem("userPermiss"))),a=0;a<e.data.length;a++)if("04"==e.data[a].meta)for(var t=0;t<e.data[a].children.length;t++)if("0402"==e.data[a].children[t].meta)for(var n=0;n<e.data[a].children[t].children.length;n++)"040201"==e.data[a].children[t].children[n].meta&&(this.deleteHistory="0"!=e.data[a].children[t].children[n].show);this.userperadmin=JSON.parse(localStorage.getItem("userperadmin")),this.getSearchParamsFun()},methods:{deleteMuchFun:function(){this.dialogInfo.flag=!1,this.dialogInfo.visible=!0},deleteDialog:function(e,a){this.dialogInfo.flag=!0,this.dialogInfo.visible=!0,this.dialogInfo.data=[e],this.deleteInfo.data=[{date:e.date,channel:e.channel}]},deleteItemFun:function(){var e=this,a={sessionid:this.userperadmin.sessionid,deletions:this.deleteInfo.data};this.dialogInfo.loading=!0,Object(n.m)(a).then(function(a){e.dialogInfo.loading=!1,e.dialogInfo.visible=!1,0===a.data.status?(e.first=0,e.toast("删除成功","success"),e.getCostRecordFun()):1===a.data.status?e.$router.replace("/login"):e.toast(a.data.statusMsg,"error")}).catch(function(a){e.dialogInfo.loading=!1,e.toast("服务器错误，请联系管理员","error")})},selectRow:function(e,a){this.deleteInfo.data=[];for(var t=0;t<e.length;t++){var n={date:e[t].date,channel:e[t].channel};this.deleteInfo.data.push(n)}},selectAll:function(e){this.deleteInfo.data=[];for(var a=0;a<e.length;a++){var t={date:e[a].date,channel:e[a].channel};this.deleteInfo.data.push(t)}},indexFormatter:function(e){return this.tableInfo.pageSize*(this.tableInfo.pageId-1)+1+e},pageSizeChange:function(e){this.tableInfo.pageId=1,this.tableInfo.pageSize=e,this.first=this.tableInfo.first,this.getCostRecordFun()},currentPageChange:function(e){this.tableInfo.pageId=e,this.first=this.tableInfo.first,this.getCostRecordFun()},searchForHistoryFun:function(){0!==this.searchInfo.dateRange.length&&(this.searchInfo.dateRange[0]=Object(s.a)(this.searchInfo.dateRange[0]),this.searchInfo.dateRange[1]=Object(s.a)(this.searchInfo.dateRange[1])),this.getCostRecordFun()},getSearchParamsFun:function(){var e=this,a={sessionid:this.userperadmin.sessionid};this.searchInfo.loading=!0,Object(n.D)(a).then(function(a){e.searchInfo.loading=!1,0===a.data.status?(e.searchInfo.channelNameList=a.data.channelNameList,e.searchInfo.channelList=a.data.channelNoList):1===a.data.status?e.$router.replace("/login"):e.toast(a.data.statusMsg,"error")}).catch(function(a){e.searchInfo.loading=!1,e.toast("服务器错误，请联系管理员","error")})},getCostRecordFun:function(){var e=this,a={sessionid:this.userperadmin.sessionid,pageId:this.tableInfo.pageId-1,pageSize:this.tableInfo.pageSize,first:this.first};""!==this.searchInfo.channelNameSelected.replace(/[-]/g,"")&&(a.channelName=this.searchInfo.channelNameSelected.replace(/[-]/g,"")),""!==this.searchInfo.channelSelected.replace(/[-]/g,"")&&(a.channel=this.searchInfo.channelSelected.replace(/[-]/g,"")),""!==this.searchInfo.channelSelected.replace(/[-]/g,"")&&(a.channel=this.searchInfo.channelSelected.replace(/[-]/g,"")),void 0!==this.searchInfo.dateRange[0]&&(a.minDate=this.searchInfo.dateRange[0]),void 0!==this.searchInfo.dateRange[1]&&(a.maxDate=this.searchInfo.dateRange[1]),this.loading=!0,Object(n.F)(a).then(function(a){e.loading=!1,0===a.data.status?(e.tableInfo.tableData=a.data.costList,a.data.listSize&&(e.tableInfo.dataSize=parseInt(a.data.listSize))):1===a.data.status?e.$router.replace("/login"):e.toast(a.data.statusMsg,"error")}).catch(function(a){e.loading=!1,e.toast("服务器错误，请联系管理员","error")})},toast:function(e,a){this.$message({type:a,message:e})}}},i={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"page record-history"},[e._m(0),e._v(" "),t("section",{staticClass:"action-wrapper clearfix"},[t("div",{staticClass:"fleft"},[t("el-select",{attrs:{clearable:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"选择/输入渠道"},model:{value:e.searchInfo.channelNameSelected,callback:function(a){e.$set(e.searchInfo,"channelNameSelected",a)},expression:"searchInfo.channelNameSelected"}},e._l(e.searchInfo.channelNameList,function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),e._v(" "),t("el-select",{attrs:{clearable:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"选择/输入渠道号"},model:{value:e.searchInfo.channelSelected,callback:function(a){e.$set(e.searchInfo,"channelSelected",a)},expression:"searchInfo.channelSelected"}},e._l(e.searchInfo.channelList,function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})}))],1),e._v(" "),t("div",{staticClass:"fleft",attrs:{id:"dateRangeInput"}},[t("span",{staticClass:"label"},[e._v("选择日期:")]),e._v(" "),t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchInfo.dateRange,callback:function(a){e.$set(e.searchInfo,"dateRange",a)},expression:"searchInfo.dateRange"}})],1),e._v(" "),t("div",{staticClass:"fleft"},[t("button",{staticClass:"btn primary",on:{click:e.searchForHistoryFun}},[t("i",{staticClass:"fa fa-search"}),e._v("查询")])]),e._v(" "),t("div",{staticClass:"fright"},[t("button",{directives:[{name:"show",rawName:"v-show",value:e.deleteHistory,expression:"deleteHistory"}],staticClass:"btn error",on:{click:e.deleteMuchFun}},[t("i",{staticClass:"fa fa-trash"}),e._v("一键删除")])])]),e._v(" "),t("section",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-wrapper",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-text":"正在加载"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData,border:""},on:{select:e.selectRow,"select-all":e.selectAll}},[t("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),t("el-table-column",{attrs:{type:"index",index:e.indexFormatter,label:"序号",width:"70"}}),e._v(" "),t("el-table-column",{attrs:{prop:"date",label:"日期"}}),e._v(" "),t("el-table-column",{attrs:{prop:"channelName",label:"渠道"}}),e._v(" "),t("el-table-column",{attrs:{prop:"channel",label:"渠道号"}}),e._v(" "),t("el-table-column",{attrs:{prop:"cost",label:"成本金额"}}),e._v(" "),t("el-table-column",{attrs:{prop:"action",label:"删除"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("a",{attrs:{href:"javascript:;"}},[t("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"},on:{click:function(t){e.deleteDialog(a.row,a.$index)}}})])]}}])})],1),e._v(" "),t("el-pagination",{staticClass:"paginationWrapper",attrs:{background:"","current-page":e.tableInfo.pageId,"page-sizes":e.tableInfo.pageSizes,"page-size":e.tableInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.dataSize},on:{"size-change":e.pageSizeChange,"current-change":e.currentPageChange}})],1),e._v(" "),t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogInfo.loading,expression:"dialogInfo.loading"}],attrs:{title:"删除记录",visible:e.dialogInfo.visible,width:"600px","element-loading-spinner":"el-icon-loading","element-loading-text":"正在加载"},on:{"update:visible":function(a){e.$set(e.dialogInfo,"visible",a)}}},[e.dialogInfo.flag?t("div",{staticClass:"item"},[t("span",{staticStyle:{color:"#CD270D"}},[e._v("是否删除")]),e._v(" "),t("el-table",{attrs:{data:e.dialogInfo.data,border:""}},[t("el-table-column",{attrs:{property:"date",label:"日期"}}),e._v(" "),t("el-table-column",{attrs:{property:"channelName",label:"渠道"}}),e._v(" "),t("el-table-column",{attrs:{property:"channel",label:"渠道号"}}),e._v(" "),t("el-table-column",{attrs:{property:"cost",label:"成本金额"}})],1),e._v(" "),t("p",[e._v("删除后不可恢复，点击后“确认”删除，点击“取消”返回录入历史页面")])],1):e._e(),e._v(" "),e.dialogInfo.flag?e._e():t("p",[e._v("是否"),t("span",{staticStyle:{color:"#CD270D"}},[e._v("批量删除")]),e._v("选中数据，删除后不可恢复。点击“确认”删除，点击“取消”关闭窗口，返回成本录入历史页面。")]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.dialogInfo.visible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteItemFun}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,a=this._self._c||e;return a("div",{staticClass:"bread-nav"},[a("p",[this._v("当前位置：数据中心 > 成本录入历史")])])}]},o=t("Z0/y")(l,i,!1,function(e){t("hsIX")},"data-v-da269602",null);a.default=o.exports},hsIX:function(e,a){}});